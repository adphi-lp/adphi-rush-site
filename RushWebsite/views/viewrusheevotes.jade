extends layout

block head
  title='View all Rushee Votes'  
  link(rel='stylesheet',href=basepath+'/css/viewbrothersvote.css')

block content
  .rushees-wrapper
    h1.rushees-title View all rushees votes
    .votes-wrapper
      h2.title Votes
      .votes-content
        table.votes-table
          tr.votes-header-row
            th.votes-status Status
            th.votes-header-name Rushee Name
            -for (var i = 0; i < voteTypes.length; i++)
              -var voteType = voteTypes[i];
              th.votes-header-cell #{voteType.name}
            th.votes-header-cell Vote Score
            th.votes-header-cell Total Non-Zero
            th.votes-header-cell Sponsor(s)
            th.votes-header-cell Last comment or seen
            
          -for (var i = 0; i < rushees.length; i++)
            -var r = rushees[i];
            
            -var votesRowClass = r.visible !== false ? 'votes-row' : 'votes-row votes-hidden';
            tr(class=votesRowClass)
              td.votes-status
                .rushee-status(style='color:#{r.status.type.color};')
                  | #{r.status.type.name}
              td.votes-name
                a.rushee-name(href=basepath+'/vote?rID='+r._id) #{r.name}
                -for (var j = 0; j < voteTypes.length; j++)
                  -var voteType = voteTypes[j];
                  -var voteCount = r.countVotesByType[voteType._id]
                  -if (voteType.value >= 0 || voteCount === 0)
                    td.votes-cell #{voteCount}
                  -else
                    td.votes-cell(style='color:red; font-weight:bold;') #{voteCount}
              td.votes-cell #{r.voteScore}
              td.votes-cell #{r.voteTotal}
              td.votes-cell
                -if (r.sponsorsNameList.length > 0)
                  .rushee-info-data #{r.sponsorsNameList.join(', ')}
                -else
                  .rushee-info-data.missing-sponsor NEED SPONSOR
              -if (r.status.type._id !== 'IN')
                -if (r.comments.length === 0)
                  td.votes-cell #{r.status.shorttime}
                -else if (r.status.type.ts > r.comments[0].ts)
                  td.votes-cell #{r.status.shorttime}
                -else
                  td.votes-cell #{r.comments[0].shorttime}
              -else
                td.votes-cell In house